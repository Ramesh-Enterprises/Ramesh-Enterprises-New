<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ramesh Fun Hub</title>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>
<style>
:root{--bg-dark:#0f1220;--text-dark:#fff;--card-dark:#1b1f3a;--accent:#ffcc00;}
body{margin:0;font-family:"Trebuchet MS",sans-serif;background:var(--bg-dark);color:var(--text-dark);}
.section{display:none;padding:15px;}
.active{display:block;}
.card{background:var(--card-dark);padding:12px;margin:10px 0;border-radius:10px;}
.grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(120px,1fr));gap:10px;}
button{background:var(--accent);border:none;padding:10px 12px;margin:3px;border-radius:6px;font-weight:bold;cursor:pointer;}
input{padding:10px;margin:5px;width:95%;border-radius:6px;border:none;font-size:14px;}
#xpBarContainer{background:#333;border-radius:10px;margin-top:5px;}
#xpBar{height:16px;width:0%;background:var(--accent);border-radius:10px;transition:width 0.5s;}
</style>
</head>
<body>

<!-- LOGIN -->
<div id="loginSection" class="section active">
  <div class="card">
    <h2>Login</h2>
    <input type="email" id="loginEmail" placeholder="Email">
    <input type="password" id="loginPass" placeholder="Password">
    <button onclick="loginUser()">Login</button>
    <p>Or <a href="#" onclick="showSection('registerSection')">Register</a></p>
    <p id="loginMsg"></p>
  </div>
</div>

<!-- REGISTER -->
<div id="registerSection" class="section">
  <div class="card">
    <h2>Register</h2>
    <input type="email" id="regEmail" placeholder="Email">
    <input type="password" id="regPass" placeholder="Password">
    <button onclick="registerUser()">Register</button>
    <p>Or <a href="#" onclick="showSection('loginSection')">Login</a></p>
    <p id="regMsg"></p>
  </div>
</div>

<!-- HUB -->
<div id="hub" class="section">
  <h1>ğŸ”¥ Ramesh Fun Hub ğŸ”¥</h1>
  <div class="card">
    <p id="userStats"></p>
    <div id="xpBarContainer"><div id="xpBar"></div></div>
    <p id="xpText"></p>
  </div>
  <div class="card">
    <h2>ğŸ† Top Players</h2>
    <div id="hubLeaderboard"></div>
  </div>
  <div class="card">
    <h2>ğŸŸ¢ Online Users</h2>
    <p id="onlineUsers"></p>
  </div>
  <div class="grid">
    <button onclick="showSection('games')">ğŸ® Games</button>
    <button onclick="showSection('generators')">ğŸ“ Generators</button>
    <button onclick="showSection('ai')">ğŸ¤– AI Chat</button>
    <button id="adminBtn" style="display:none;" onclick="showSection('admin')">ğŸ‘‘ Admin</button>
    <button onclick="showSection('custom')">ğŸ¨ Customize</button>
    <button onclick="logoutUser()">Logout</button>
  </div>
</div>

<!-- GAMES -->
<div id="games" class="section">
  <h2>ğŸ® Games</h2>
  <div class="grid">
    <button onclick="guessNumber()">Guess Number</button>
    <button onclick="diceRoll()">Dice Roll</button>
    <button onclick="rockPaperScissors()">Rock Paper Scissors</button>
    <button onclick="clickSpeedTest()">Click Speed Test</button>
    <button onclick="typingTest()">Typing Test</button>
  </div>
  <button onclick="showSection('hub')">â¬… Back</button>
</div>

<!-- GENERATORS -->
<div id="generators" class="section">
  <h2>ğŸ“ Generators</h2>
  <div class="grid">
    <button onclick="generate('business')">Business Name</button>
    <button onclick="generate('joke')">Joke</button>
    <button onclick="generate('nickname')">Nickname</button>
    <button onclick="generate('poetry')">Poetry</button>
    <button onclick="generate('challenge')">Random Challenge</button>
  </div>
  <p id="genOutput"></p>
  <button onclick="showSection('hub')">â¬… Back</button>
</div>

<!-- AI CHAT -->
<div id="ai" class="section">
  <h2>ğŸ¤– AI Chat</h2>
  <input id="aiInput" placeholder="Say something">
  <button onclick="aiRespond()">Talk</button>
  <p id="aiOutput"></p>
  <button onclick="showSection('hub')">â¬… Back</button>
</div>

<!-- CUSTOMIZATION -->
<div id="custom" class="section">
  <h2>ğŸ¨ Customize</h2>
  <button onclick="toggleDark()">Toggle Dark / Light</button>
  <input type="color" id="accentPicker" onchange="changeAccent(this.value)">
  <button onclick="showSection('hub')">â¬… Back</button>
</div>

<!-- ADMIN -->
<div id="admin" class="section">
  <h2>ğŸ‘‘ Admin Panel</h2>
  <button onclick="addCoins(500)">+500 Coins</button>
  <button onclick="wipeLeaderboard()">Reset Leaderboard</button>
  <button onclick="showSection('hub')">â¬… Back</button>
</div>

<script>
// FIREBASE CONFIG
const firebaseConfig = {
  apiKey: "AIzaSyDp_tfDDL5weoyBcs3_OknW0wNLM8PVQrQ",
  authDomain: "ramesh-fun-hub.firebaseapp.com",
  databaseURL: "https://ramesh-fun-hub-default-rtdb.firebaseio.com",
  projectId: "ramesh-fun-hub",
  storageBucket: "ramesh-fun-hub.firebasestorage.app",
  messagingSenderId: "670023868444",
  appId: "1:670023868444:web:7f1f2bc88408fb3ad53fd9"
};
firebase.initializeApp(firebaseConfig);
const auth = firebase.auth();
const db = firebase.database();

let user=null, coins=0, xp=0, level=1;

// SECTION SWITCH
function showSection(id){
  document.querySelectorAll('.section').forEach(s=>s.classList.remove('active'));
  document.getElementById(id).classList.add('active');
}

// REGISTER USER
function registerUser(){
  const email=document.getElementById('regEmail').value;
  const pass=document.getElementById('regPass').value;
  auth.createUserWithEmailAndPassword(email,pass)
    .then(res=>{
      user=res.user;
      coins=0; xp=0; level=1;
      saveStats();
      showSection('hub');
    })
    .catch(err=>document.getElementById('regMsg').innerText=err.message);
}

// LOGIN USER
function loginUser(){
  const email=document.getElementById('loginEmail').value;
  const pass=document.getElementById('loginPass').value;
  auth.signInWithEmailAndPassword(email,pass)
    .then(res=>{
      user=res.user;
      const isAdmin = (user.email==='rameshenterprises@protonmail.com');
      db.ref('users/'+user.uid).once('value').then(snap=>{
        const data = snap.val();
        coins = data?.coins || 0;
        xp = data?.xp || 0;
        level = data?.level || 1;
        updateStats();
        trackOnline();
        updateLeaderboard();
        showSection('hub');
        if(isAdmin) document.getElementById('adminBtn').style.display='block';
      });
    })
    .catch(err=>document.getElementById('loginMsg').innerText=err.message);
}

// LOGOUT
function logoutUser(){auth.signOut(); showSection('loginSection');}

// SAVE STATS
function saveStats(){db.ref('users/'+user.uid).set({coins,xp,level,email:user.email}); updateStats();}
function addCoins(a){coins+=a; saveStats();}
function addXP(a){xp+=a; while(xp>=level*100){xp-=level*100;level++;} saveStats();}
function updateStats(){
  document.getElementById('userStats').innerText=`ğŸ‘¤ ${user.email} | ğŸª™ ${coins} | â­ Lv.${level}`;
  document.getElementById('xpBar').style.width=Math.floor(xp/(level*100)*100)+'%';
  document.getElementById('xpText').innerText=`XP: ${xp}/${level*100}`;
}

// ONLINE USERS
function trackOnline(){
  const uid=user.uid;
  const onlineRef=db.ref('online/'+uid);
  const conRef=db.ref('.info/connected');
  conRef.on('value',snap=>{
    if(snap.val()){onlineRef.set(true); onlineRef.onDisconnect().remove();}
  });
  db.ref('online').on('value',snap=>{
    document.getElementById('onlineUsers').innerText=snap.numChildren()+' players online';
  });
}

// LEADERBOARD
function updateLeaderboard(){
  db.ref('users').orderByChild('coins').limitToLast(10).on('value',snap=>{
    const data = snap.val(); if(!data) return;
    let arr=[]; for(let uid in data) arr.push({email:data[uid].email, coins:data[uid].coins, level:data[uid].level});
    arr.sort((a,b)=>b.coins-a.coins);
    let html=''; arr.forEach(u=>{html+=`<div>${u.email}: ${u.coins} ğŸª™ | Lv.${u.level}</div>`;});
    document.getElementById('hubLeaderboard').innerHTML=html;
  });
}

// ADMIN
function wipeLeaderboard(){db.ref('users').remove(); alert("Leaderboard wiped");}

// GAMES
function guessNumber(){let n=Math.ceil(Math.random()*10); let ans=prompt("Guess 1-10"); if(Number(ans)===n){alert("Correct! +20 Coins +20 XP"); addCoins(20); addXP(20);} else alert("Wrong! It was "+n);}
function diceRoll(){let d=Math.ceil(Math.random()*6); alert("You rolled "+d+"! +Coins:"+d*5+" +XP:"+d*5); addCoins(d*5); addXP(d*5);}
function rockPaperScissors(){const c=["Rock","Paper","Scissors"],ai=c[Math.floor(Math.random()*3)]; let p=prompt("Rock, Paper, Scissors?"); let msg="AI chose "+ai+"!"; if(p.toLowerCase()===ai.toLowerCase()) msg+=" Draw!"; else if((p==="Rock"&&ai==="Scissors")||(p==="Paper"&&ai==="Rock")||(p==="Scissors"&&ai==="Paper")){msg+=" You win! +30 Coins +30 XP"; addCoins(30); addXP(30);} else msg+=" You lose!"; alert(msg);}
function clickSpeedTest(){alert("Click OK 5 times quickly"); let start=Date.now(); for(let i=0;i<5;i++) prompt("Click!"); let t=Math.floor((Date.now()-start)/1000); alert("Time: "+t+"s | Coins/XP: "+(50-t)); addCoins(50-t); addXP(50-t);}
function typingTest(){let txt="Ramesh Fun Hub"; let start=Date.now(); let input=prompt("Type: "+txt); let t=Math.floor((Date.now()-start)/1000); if(input===txt){alert("Perfect! +40 Coins +40 XP"); addCoins(40); addXP(40);} else alert("Incorrect.");}

// GENERATORS
const genData={business:["Ramesh Corp","Fun Studios"],joke:["Why code? Fun!","JavaScript is fun!"],nickname:["Ramesh123","FunMaster"],poetry:["Roses are red, code is blue","JS makes dreams true"],challenge:["Do 10 pushups","Drink water"]};
function generate(type){const arr=genData[type]; const val=arr[Math.floor(Math.random()*arr.length)]; document.getElementById('genOutput').innerText=val;}

// AI
function aiRespond(){const input=document.getElementById('aiInput').value.toLowerCase(); const responses=["Hmm!","ğŸ˜‚","I see!","Try harder!","Cool!"]; document.getElementById('aiOutput').innerText=responses[Math.floor(Math.random()*responses.length)];}

// CUSTOMIZATION
let darkMode=true;
function toggleDark(){if(darkMode){document.body.style.background='#fff';document.body.style.color='#000';}else{document.body.style.background='#0f1220';document.body.style.color='#fff';} darkMode=!darkMode;}
function changeAccent(c){document.documentElement.style.setProperty('--accent',c);}
</script>
</body>
</html>
